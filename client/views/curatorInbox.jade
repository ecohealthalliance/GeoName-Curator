template(name="curatorInbox")
  .container-fluid
    .row
      .col-sm-6.curator-inbox-sources
        .row.curator-inbox-header
          h2 Sources
          .curator-inbox-options
            a.curator-filter-calendar-icon(class="{{#if calendarState}} active {{/if}}")
              i.fa.fa-calendar
            a.curator-filter-reviewed-icon(class="{{#unless reviewFilterActive}} active {{/unless}}")
              i.fa.fa-check-circle
            .input-group
              input#curator-inbox-article-filter.map-search.form-control(type="text" placeholder="Filter by event name")
              i.fa.fa-search.search-icon
        .row.curator-inbox-datepicker(class="{{#if calendarState}} active {{/if}}")
          .text-center
            #date-picker.inlineRangePicker
          .text-center
            a#calendar-btn-apply.btn.btn-primary(href="") Apply
            a#calendar-btn-reset.btn.btn-primary(href="") Reset
            a#calendar-btn-cancel.btn.btn-default(href="") Cancel
        .curator-inbox-source-list.row
          if isReady
            each day in days
              +curatorInboxSection(
                date=day
                index=@index
                reviewFilter=reviewFilter
                selectedSourceId=selectedSourceId)
          else
            .loading
      if isReady
        .col-sm-6.curator-source-details
          +curatorSourceDetails selectedSourceId=selectedSourceId

template(name="curatorInboxSection")
  if post
    .col-xs-12.curator-inbox-section-head
      .pull-left
        b {{formattedDate}}
        .spacer
        | {{count}} Articles
      .pull-right
        i.fa.fa-lg
          if isOpen
            i.fa.fa-chevron-circle-down
          else
            i.fa.fa-chevron-circle-left
    if isOpen
      +reactiveTable(
        collection=posts
        settings=settings
        selector=selector
        class="table table-hover curator-inbox-table")

template(name="curatorSourceDetails")
  with post
    .curator-inbox-header.curator-source-details-header(class="{{#if isReviewed}} reviewed {{/if}}")
      h2= title
      .curator-source-details-options
        .controls
          i.fa.fa-align-left.toggle-source-content(
            class="{{#if contentIsOpen}} active {{/if}}"
            data-toggle="tooltip"
            data-placement="bottom"
            title="Toggle source text")
        button.btn.btn-success.toggle-reviewed(class="{{#if isReviewed}} reviewed {{/if}}")
          if isReviewed
            span Reviewed
          else
            span Mark Reviewed
      if notifying
        .notification
          i.fa.fa-check-circle.confirmation
          p Preparing next source
          i.fa.fa-cog.fa-spin
    .curator-source-details-content
      if contentIsOpen
        .curator-source-details-copy-wrapper
          .curator-source-details-copy= content
      +curatorEvents selectedSourceId=selectedSourceId
      if notifying
        .veil
