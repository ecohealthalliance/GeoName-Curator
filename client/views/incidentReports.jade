template(name="incidentReports")
  .row
    .col-md-6
      +addIncidentReport
      if incidents.length
        +reactiveTable collection=incidents settings=getSettings
      else
        p No incident reports are associated with this event.

template(name="addIncidentReport")
  if currentUser
    .tab-form
      .row
        .col-md-6.col-md-offset-3.col-sm-12
          button.btn.secondary-btn.btn-block.open-incident-form(type="button")
            i.fa.fa-plus-circle
            | Add Incident Report

template(name="incidentReport")
  td(colspan="5")
    .tr-detail-container.form-horizontal
      .row
        .col-sm-2.control-label Source:
        .col-sm-10
          each val in url
            p.form-control-static
              a.ref-link(href="{{val}}" target="_blank") {{val}}
      if date
        .row
          .col-sm-2.control-label Reported:
          .col-sm-10
            p.form-control-static {{formatDate date}}
      .row
        .col-sm-2.control-label Location:
        .col-sm-10
          if locations.length
            each locations
              p.form-control-static {{formatLocation(this)}}
          else
            p.form-control-static No location specified.
      if species
        .row
          .col-sm-2.control-label Species:
          .col-sm-10
            p.form-control-static
              em {{species}}
      if status
        .row
          .col-sm-2.control-label Status:
          .col-sm-10
            p.form-control-static {{status}}
      .row
        if cases
          +incidentDetails label="Cases" value=cases
        if deaths
          +incidentDetails label="Deaths" value=deaths
        if specify
          +incidentDetails label="Other" value=specify
      .row
        .col-sm-2.control-label Travel Related:
        .col-sm-10
          p.form-control-static
            i.fa.fa-lg(class="{{travelIcon}}")

template(name="incidentDetails")
  .col-sm-2.control-label {{label}}:
  .col-sm-10
    p.form-control-static {{value}}

template(name="incidentModal")
  .modal.fade(role="dialog")
    .modal-dialog
      .modal-content
        .modal-header
          h4.modal-title Add Incident Report
        .modal-body
          form#add-incident.form-horizontal(novalidate)
            .form-group
              label.col-lg-3.control-label Article URL
              .col-lg-9
                +articleSelect2 selectId="articleSource" articles=articles
            .form-group
              label.col-lg-3.control-label Date
              .col-lg-9
                input.form-control.datePicker(type="text" name="date" data-DateTimePicker)
            .form-group
              label.col-lg-3.control-label Location
              .col-lg-9
                +locationSelect2 selectId="incident-location-select2" multiple="true"
            .form-group
              label.col-lg-3.control-label Species
              .col-lg-9
                input.form-control(type="text" name="species")
            .form-group
              label.col-lg-3.control-label Status
              .col-lg-9
                select.form-control(name="status")
                  option(value="")
                  option(value="suspected") Suspected
                  option(value="confirmed") Confirmed
                  option(value="revoked") Revoked
            .form-group
              label.col-lg-3.control-label Incident Type
              .col-lg-9
                select.form-control(name="incidentType" required)
                  option(value="")
                  option(value="cases") Case Count
                  option(value="deaths") Death Count
                  option(value="other") Other
            if showCountForm
              .form-group
                label.col-lg-3.control-label Count
                .col-lg-9
                  input.form-control(name="count" type="number" min="0" required)
            if showOtherForm
              .form-group
                label.col-lg-3.control-label Specify Other
                .col-lg-9
                  input.form-control(name="other" type="text" required)
            .form-group
              .col-lg-9.col-lg-offset-3
                .checkbox
                  label
                    input(type="checkbox" value="1" name="travelRelated")
                    | Travel related
        .modal-footer
          button.btn.secondary-btn(type="button" data-dismiss="modal") Close
          button.btn.main-btn.save-modal-close(type="button") Save and Close
          button.btn.main-btn.save-modal(type="button") Save
