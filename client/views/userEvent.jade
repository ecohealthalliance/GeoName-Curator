template(name="userEvent")
  .event
    section.event--basic-info.container-fluid-padded
      with userEvent
        +summary

    section.event--detailed-info
      if incidents.length
        .tabs-wrapper
          ul.tabs.primary-tabs.container-fluid-padded(role="tablist")
            li(class="{{#if incidentView}}active{{/if}}" role="presentation")
              a(href="{{pathFor route='user-event' _id=userEvent._id _view='incidents'}}") Incident Reports
            li(class="{{#if locationView}}active{{/if}}" role="presentation")
              a(href="{{pathFor route='user-event' _id=userEvent._id _view='locations'}}") Locations

        .tab-content
          .tab-pane.active(role="tabpanel")
            +Template.dynamic template=view data=templateData
      else
        +addIncidentReport

    section.event--articles
      +articles

template(name="summary")
  .container-flex
    .event--details
      .event-name-wrap
        h1.event-name= eventName
        if isInRole "admin"
          i.fa.fa-edit.edit-event-details(
            data-toggle="modal"
            data-target="#edit-event-modal"
            data-editing='name')
      p.disease-name
        if disease
          span= disease
        else
          span.not-available No disease available.
          if isInRole "admin"
            i.fa.fa-plus-circle.edit-event-details(
              data-toggle="modal"
              data-target="#edit-event-modal"
              data-editing='disease')
      p.abstract.summary(class="{{#unless summary}} shift-up {{/unless}}")
        if summary
          span= summary
        else
          span.not-available No summary available.
          if isInRole "admin"
            i.fa.fa-plus-circle.edit-event-details(
              data-toggle="modal"
              data-target="#edit-event-modal"
              data-editing='summary')
    .event--metadata.container-flex
      .event--metadata--counts.container-flex.no-gutter
        .count.flex-col
          span= caseCount
          h4 Incident Reports
        .count.flex-col
          span= articleCount
          h4 Sources
      .event--metadata--secondary-content.container-flex
        .secondary-content
          p Created by: #{createdByUserName} on {{formatDate creationDate}}
        .secondary-content
          p Last Modified by: #{lastModifiedByUserName} on {{formatDate lastModifiedDate}}
        .secondary-content
          button.copy-link.btn.btn-xs.btn-default(
            type="button"
            data-clipboard-text="{{urlFor 'user-event'}}"
            class="{{#if copied}} copied {{/if}}")
            if copied
              i.fa.fa-check
              span Coppied
            else
              i.fa.fa-share-alt
              span Copy Event Link

  +editEventDetailsModal

template(name="locationList")
  .container-flex.no-gutter
    .flex-col.bordered
      if incidentLocations.length
        .tab-form
          +reactiveTableFilter id="locationFilter" label=" " class="input-group table-filter"
        +reactiveTable collection=incidentLocations settings=getSettings
      else
        p No locations are associated with this event.
    .flex-col
      if incidentLocations.length
        +map event=userEvent incidentLocations=incidentLocations
  #proMedModal.modal.fade(role='dialog')
    .modal-dialog.modal-lg(role='document')
      .modal-content
        .modal-header
          +modalCloseButton
          h4
            a#proMedURL
        .modal-body
          iframe#proMedIFrame

template(name="location")
  td(colspan="4")
    .tr-detail-container.form-horizontal
      .form-group
        .col-md-12
          h5
            i.fa.fa-link
            | Sources
          ul
            each sources
             li
                a(href=this)= this
                  i.fa.fa-external-link
      .form-group
        .col-md-12
          i.fa.fa-globe
          a(href="http://www.geonames.org/{{id}}")= name
            i.fa.fa-external-link
      .form-group
        .col-md-12
          i.fa.fa-info-circle
          em Added on {{formatDate addedDate}}
